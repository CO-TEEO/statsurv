<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="In addition to reporting the details of the most likely cluster (MLC),
scanstatistics objects also contain detailed information about the likelihood of a cluster in
all possible spatial zones and temporal durations. This information can be used to identify any
independent secondary clusters that exist in the study area. When searching for these secondary
clusters, we are generally interested in clusters that do not significantly overlap the primary
cluster."><title>Remove overlapping clusters from scan statistics — remove_overlapping_clusters • statsurv</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Remove overlapping clusters from scan statistics — remove_overlapping_clusters"><meta property="og:description" content="In addition to reporting the details of the most likely cluster (MLC),
scanstatistics objects also contain detailed information about the likelihood of a cluster in
all possible spatial zones and temporal durations. This information can be used to identify any
independent secondary clusters that exist in the study area. When searching for these secondary
clusters, we are generally interested in clusters that do not significantly overlap the primary
cluster."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">statsurv</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/spacetime_data.html">Spacetime Data in statsurv</a>
    <a class="dropdown-item" href="../articles/statsurv_overview.html">An introduction to `statsurv`</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/CO-TEEO/statsurv/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Remove overlapping clusters from scan statistics</h1>
      <small class="dont-index">Source: <a href="https://github.com/CO-TEEO/statsurv/blob/HEAD/R/report_top_clusters.R" class="external-link"><code>R/report_top_clusters.R</code></a></small>
      <div class="d-none name"><code>remove_overlapping_clusters.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>In addition to reporting the details of the most likely cluster (MLC),
<code>scanstatistics</code> objects also contain detailed information about the likelihood of a cluster in
all possible spatial zones and temporal durations. This information can be used to identify any
independent secondary clusters that exist in the study area. When searching for these secondary
clusters, we are generally interested in clusters that do not significantly overlap the primary
cluster.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">remove_overlapping_clusters</span><span class="op">(</span></span>
<span>  <span class="va">scan_result</span>,</span>
<span>  <span class="va">zones</span>,</span>
<span>  <span class="va">order_by</span>,</span>
<span>  take_highest <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  max_overlap_frac <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>scan_result</dt>
<dd><p>An object of class <code>scanstatistic</code>, such as generated by
<code><a href="https://rdrr.io/pkg/scanstatistics/man/scan_bayes_negbin.html" class="external-link">scan_bayes_negbin</a></code> or <code><a href="scan_eb_poisson2.html">scan_eb_poisson2</a></code>.</p></dd>


<dt>zones</dt>
<dd><p>A list of integer vectors. Each vector corresponds to a single
zone; its elements are the numbers of the locations in that zone.</p></dd>


<dt>order_by</dt>
<dd><p>The column to order the clusters by. Any column in <code>scan_result$observed</code> or
<code>scan_result$posteriors$window_posteriors</code> is valid. Specified as bare text.</p></dd>


<dt>take_highest</dt>
<dd><p>Boolean. Should the clusters by ordered from highest to lowest (<code>take_highest = TRUE</code>) or from lowest to highest (<code>take_highest = FALSE</code>).</p></dd>


<dt>max_overlap_frac</dt>
<dd><p>Optional. What is the maximum overlap fraction that should be allowed
between clusters? Defaults to 0.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>An object of class <code>scanstatistic</code>, with the <code>observed</code> or <code>posteriors$window_posteriors</code></p>


<p>data frame modified to only contain non-overlapping clusters. Otherwise identical to the
<code>scan_result</code> input.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>remove_overlapping_clusters</code> goes through the information about the likelihood of a
cluster in all possible spatial zones and temporal durations, and only keeps the information
from non-overlapping spatial zones. Potential clusters are gone through from most-likely to
least likely (as determined by <code>order_by</code> and <code>take_highest</code>). Information about a spatial zone
and duration is retained if the fraction of spatial locations in the zone that are present in
any already identified cluster is less than or equal to <code>max_overlap_frac</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>report_top_clusters</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"NM_data"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"NM_county_sf"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">zones</span> <span class="op">&lt;-</span> <span class="fu"><a href="create_zones.html">create_zones</a></span><span class="op">(</span><span class="va">NM_county_sf</span>, max_k <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">scanres</span> <span class="op">&lt;-</span> <span class="fu"><a href="scan_eb_poisson2.html">scan_eb_poisson2</a></span><span class="op">(</span><span class="va">NM_data</span>, <span class="va">count</span>, <span class="va">zones</span>,</span></span>
<span class="r-in"><span>                            <span class="va">baseline_est</span>, n_mcsim <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Order by cluster score</span></span></span>
<span class="r-in"><span><span class="fu">remove_overlapping_clusters</span><span class="op">(</span><span class="va">scanres</span>, <span class="va">zones</span>, order_by <span class="op">=</span> <span class="va">score</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Data distribution:                Poisson</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Type of scan statistic:           expectation-based</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Setting:                          univariate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of locations considered:   32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Maximum duration considered:      19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of spatial zones:          144</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of Monte Carlo replicates: 100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Monte Carlo P-value:              0.079</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Gumbel P-value:                   NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Most likely event duration:       7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ID of locations in MLC:           1, 10, 26, 30, 32</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Order by mc-pvalue</span></span></span>
<span class="r-in"><span><span class="fu">remove_overlapping_clusters</span><span class="op">(</span><span class="va">scanres</span>, <span class="va">zones</span>, order_by <span class="op">=</span> <span class="va">mc_pvalue</span>,</span></span>
<span class="r-in"><span>                            take_highest <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Data distribution:                Poisson</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Type of scan statistic:           expectation-based</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Setting:                          univariate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of locations considered:   32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Maximum duration considered:      19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of spatial zones:          144</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of Monte Carlo replicates: 100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Monte Carlo P-value:              0.079</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Gumbel P-value:                   NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Most likely event duration:       7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ID of locations in MLC:           1, 10, 26, 30, 32</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Order by mc-pvalue, allow some overlap</span></span></span>
<span class="r-in"><span><span class="fu">remove_overlapping_clusters</span><span class="op">(</span><span class="va">scanres</span>, <span class="va">zones</span>, order_by <span class="op">=</span> <span class="va">mc_pvalue</span>,</span></span>
<span class="r-in"><span>                            take_highest <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>                            max_overlap_frac <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Data distribution:                Poisson</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Type of scan statistic:           expectation-based</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Setting:                          univariate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of locations considered:   32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Maximum duration considered:      19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of spatial zones:          144</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of Monte Carlo replicates: 100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Monte Carlo P-value:              0.079</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Gumbel P-value:                   NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Most likely event duration:       7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ID of locations in MLC:           1, 10, 26, 30, 32</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Paul Romer Present.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

