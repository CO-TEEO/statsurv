<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Calculate the expectation-based scan statistic using the a Poisson distribution, as
devised by Neill (2009). This function should give identical results to those calculated by
scan_eb_poisson, but is significantly faster when scanning large
areas."><title>Calculate the expectation-based Poisson scan statistic via linear algebra — scan_eb_poisson_fast • statsurv</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate the expectation-based Poisson scan statistic via linear algebra — scan_eb_poisson_fast"><meta property="og:description" content="Calculate the expectation-based scan statistic using the a Poisson distribution, as
devised by Neill (2009). This function should give identical results to those calculated by
scan_eb_poisson, but is significantly faster when scanning large
areas."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">statsurv</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/spacetime_data.html">Spacetime Data in statsurv</a>
    <a class="dropdown-item" href="../articles/statsurv_overview.html">An introduction to `statsurv`</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/CO-TEEO/statsurv/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Calculate the expectation-based Poisson scan statistic via linear algebra</h1>
      <small class="dont-index">Source: <a href="https://github.com/CO-TEEO/statsurv/blob/HEAD/R/scan_eb_poisson_fast.R" class="external-link"><code>R/scan_eb_poisson_fast.R</code></a></small>
      <div class="d-none name"><code>scan_eb_poisson_fast.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculate the expectation-based scan statistic using the a Poisson distribution, as
devised by Neill (2009). This function should give identical results to those calculated by
<code><a href="https://rdrr.io/pkg/scanstatistics/man/scan_eb_poisson.html" class="external-link">scan_eb_poisson</a></code>, but is significantly faster when scanning large
areas.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">scan_eb_poisson_fast</span><span class="op">(</span><span class="va">wide_cases</span>, <span class="va">key_matrix</span>, <span class="va">wide_baseline</span>, <span class="va">n_mcsim</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>wide_cases</dt>
<dd><p>A matrix of observed counts. Rows indicate time and are ordered from least
recent (row 1) to most recent (row <code>nrow(counts)</code>). Columns indicate locations, numbered from 1
and up. Can be generated from a data.frame with the <code><a href="pivot_for_scan.html">pivot_for_scan</a></code> function.</p></dd>


<dt>key_matrix</dt>
<dd><p>A matrix specifying how which locations belong to each zone. Each row is a
different zone and each column is a location. An element <code>(i,j)</code> is 1 if location <code>j</code> is part
of zone <code>i</code> and is 0 otherwise. Can be generated from a list specifying zones using the
<code><a href="switch_zone_rep.html">zones_to_key_matrix</a></code> function.</p></dd>


<dt>wide_baseline</dt>
<dd><p>A matrix of the same dimensions as <code>wide_cases</code>, holding the expected value
of cases at each space-time location.This value is typically estimated from past data using a
GLM or other model.</p></dd>


<dt>n_mcsim</dt>
<dd><p>A non-negative integer; the number of replicate scan
statistics to generate in order to calculate a \(P\)-value.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A list which, in addition to the information about the type of scan
   statistic, has the following components:</p>
<p></p>
<dl><dt>MLC</dt>
<dd><p>A list containing the number of the zone of the most likely
           cluster (MLC), the locations in that zone, the duration of the 
           MLC, the calculated score, and the relative risk. In order, the 
           elements of this list are named  <code>zone_number, locations, 
           duration, score, relative_risk</code>.</p></dd>

     <dt>observed</dt>
<dd><p>A data frame containing, for each combination of zone 
           and duration investigated, the zone number, duration, score, 
           relative risk. The table is sorted by score with the top-scoring 
           location on top. If <code>max_only = TRUE</code>, only contains a single 
           row corresponding to the MLC.</p></dd>

     <dt>replicates</dt>
<dd><p>A data frame of the Monte Carlo replicates of the scan 
           statistic (if any), and the corresponding zones and durations.</p></dd>

     <dt>MC_pvalue</dt>
<dd><p>The Monte Carlo \(P\)-value.</p></dd>

     <dt>Gumbel_pvalue</dt>
<dd><p>A \(P\)-value obtained by fitting a Gumbel 
           distribution to the replicate scan statistics.</p></dd>

     <dt>n_zones</dt>
<dd><p>The number of zones scanned.</p></dd>

     <dt>n_locations</dt>
<dd><p>The number of locations.</p></dd>

     <dt>max_duration</dt>
<dd><p>The maximum duration considered.</p></dd>

     <dt>n_mcsim</dt>
<dd><p>The number of Monte Carlo replicates made.</p></dd>

   
</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Neill, D. B., Moore, A. W., Sabhnani, M. and Daniel, K. (2005). 
   <em>Detection of emerging space-time clusters</em>. Proceeding of the 
   eleventh ACM SIGKDD international conference on Knowledge discovery in 
   data mining - KDD â€™05, 218.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/scanstatistics/man/scan_eb_poisson.html" class="external-link">scan_eb_poisson</a></code>, <code><a href="scan_eb_negbin_fast.html">scan_eb_negbin_fast</a></code>,
<code><a href="pivot_for_scan.html">pivot_for_scan</a></code>, <code><a href="switch_zone_rep.html">zones_to_key_matrix</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Apply scan_eb_poisson_fast to a 3x3 spatial grid with 4 time points</span></span></span>
<span class="r-in"><span><span class="co"># And inject an outbreak into the upper-left corner in the 2 most recent time points</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://magrittr.tidyverse.org" class="external-link">"magrittr"</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x_coord</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y_coord</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>, each <span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">geo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">x_coord</span>, <span class="va">y_coord</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">zones</span> <span class="op">&lt;-</span> <span class="va">geo</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">scanstatistics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/scanstatistics/man/coords_to_knn.html" class="external-link">coords_to_knn</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">scanstatistics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/scanstatistics/man/knn_zones.html" class="external-link">knn_zones</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">key_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="switch_zone_rep.html">zones_to_key_matrix</a></span><span class="op">(</span><span class="va">zones</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">outbreak_sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">outbreak_tm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">wide_cases</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">4</span>, ncol <span class="op">=</span> <span class="fl">9</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">wide_cases</span><span class="op">[</span><span class="va">outbreak_tm</span>, <span class="va">outbreak_sp</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">5</span></span></span>
<span class="r-in"><span><span class="va">wide_cases</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">9</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">2.5</span></span></span>
<span class="r-in"><span><span class="va">wide_baseline</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">4</span>, ncol <span class="op">=</span> <span class="fl">9</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">scanres</span> <span class="op">&lt;-</span> <span class="fu">scan_eb_poisson_fast</span><span class="op">(</span><span class="va">wide_cases</span>, <span class="va">key_matrix</span>, <span class="va">wide_baseline</span>,</span></span>
<span class="r-in"><span>                                n_mcsim <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Paul Romer Present.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

